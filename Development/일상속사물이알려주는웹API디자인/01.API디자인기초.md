# 1부. API 디자인 기초

> * API 를 반드시 사전에 디자인해야 하는 이유

# Chapter 01 "API 디자인이란 무엇인가?"

## 1. API 디자인이란 무엇인가?

### 1.1. 소프트웨어를 위한 웹 인터페이스 (웹 Application Programming Interface)

#### 1) 목적: 인터페이스(I/F)

* 두 개의 시스템, 대상, 조직, 그 밖의 대상들이 만나고 상호작용하는 지점을 의미함.
* API 를 사용할 때 소프트웨어 내부에서 실제로 벌어지는 구체적인 구현을 의미하는 것이 아닌, 추상화된 개념을 의미함.


####  2) HTTP 프로토콜과 사용할 수 있는 원격 API<br>

<img src="https://blog.kakaocdn.net/dn/cnUcrN/btrPRAjPguJ/8kBAFRkhzplsDzizVwZK81/img.png"  width="700"/>

* 컨슈머 - 모바일 애플리케이션은 서버 애플리케이션이 제공하는 API를 소비
* 프로바이더 - 서버 애플리케이션

### 1.2. 소프트웨어를 레고처럼

#### 1) 소셜 네트워크 서비스

<img src="https://blog.kakaocdn.net/dn/uQGbj/btrPP7XrlHz/BtXgvPkNqUzkU4kk8bQKq0/img.png"  width="700"/>

* 하나의 서비스를 만들기 위하여 여러 API들이 조립된다.
* 현재 서비스 중인 API 들은 재활용 될 수 있기 때문에 다시 만들 필요가 없고, 모든 컨슈머들이 동시에 사용할 수 있다.
* 각 API들이 사용할 리소스들이 모두 상이하기 때문에, 충분히 고려한 후 서버의 성능을 결정해야 한다.
* 인터넷만 연결되어 있다면 API 접근이 가능하여, 어디서든 실행할 수 있다. 

#### 2) API 블록의 종류 (누구에게 제공되느냐에 따라)

* 퍼블릭 API 
    * 서드파티가 제공
    * 외부에 서비스 또는 제품 형태로 제공되기 때문에, 동일한 소프트웨어를 만들거나 설치, 실행할 필요가 없다.
* 프라이빗 API
    * 개발자가 만든 애플리케이션이나, 부서 또는 회사를 위해서만 소비되는 것을 말함.
* 퍼블릭 API 와 프라이빗 API 사이에는 다양한 종류의 상호작용이 발생한다.

## 2. API 디자인이 중요한 이유

### 1.1. 퍼블릭, 프라이빗 API는 다른 개발자들도 사용한다.

* API는 소프트웨어를 만들기 위해 필요한 것이지만, 이 소프트웨어를 개발하는 것은 개발자이다.
* API 를 사용하는 코드를 작성할 때는 새로운 개발자가 이해할 수 있도록 유용하고 단순하게 작성해야 한다.
* 개발자 경험 (Developer Experience, DX)
    * API를 사용하는 개발자들의 경험.
    * API 사용을 위한 등록 절차와 어떻게 API를 사용하는지에 관해 설명하는 문서화와 문제에 처했을 떄 해결하는 것을 돕는 기술 지원 등을 의미함.

### 1.2. API 는 구현을 숨겨준다.

* 개발자와 애플리케이션은 오직 API 만 알고 있으면 된다.

### 1.3. API를 어설프게 디자인하면 끔찍한 결과가 이어진다.

* 목적에 맞지 않고, 비효율적이고 명확하지 않은 API는 아무리 문서가 이런 결함을 잘 성명한다고 해도, 사용자들은 이러한 API는 선택하지 않을 것이다.
* API 의 디자인 결함은 이 API를 사용하는 소프트웨어가 들이는 시간과 노력, 비용을 증가시키고, API 프로바이더들에게 추가적인 지원을 받게 될 가능성이 높아 프로바이더의 비용도 증가하게 된다.
* API 의 보안 측면 취약성을 야기시킬 수도 있어, 민감한 정보를 외부에 노출하거나, 접근 권한과 그룹 권한 관리를 제대로 하지 않을 수 있다.

## 3. API 디자인에 필요한 요소

* API 디자인을 할 떄는 반드시 커스터머의 측면과 프로바이더 측면으로 인터페이스의 두 가지 면을 고려해야 한다.
* 즉, API를 둘러싸고 있는 모든 맥락에 대해서 파악을 해야 한다.

#### 1) 안전한 인터페이스를 설계해야 한다.

* 민감한 데이터나 동작을 컨슈머에게 과도하게 노출해서는 안된다.

#### 2) 모든 컨텍스트를 염두에 둬야 한다.

* 어떤 제약이 있는지
* 어떻게 API 가 누구에 의해 쓰일 것인지
* 어떻게 API가 만들어질 것인지
* 어떤 식으로 성장해 나갈 것인지

#### 3) API의 모든 라이프사이클에 관여해야 한다.

* 초기 논의부터 개발, 문서화, 지속적인 개선, 제거되는 순간 사이의 모든 과정을 관여해야 한다.

#### 4) 가능한 한 일관된 API를 구축해야 한다.

* 다른 API 디자이너들과 함께 일해서, 조직에서 만들어낸 API는 모두 유사한 모양과 느낌이 들도록 한다.
* 모든 API가 이해하기 쉽고 사용하기 쉽게 만들어야 한다.

## Reference

* https://lee-s-k.tistory.com/28
* https://blog.naver.com/rinjyu/222644946455

# Chapter 02 "사용자를 위한 API 디자인하기"

* API 를 소비하는 컨슈머 소프트웨어의 입장에서 생각해보기.

## 1. 일상 속 사용자 인터페이스를 디자인하는 올바른 관점

### 1.1. 프로바이더 관점: 작업 방식(단순 기능)에 집중한다면?

<img src="https://blog.kakaocdn.net/dn/cpWmh3/btrPUm6TlmT/9YZfIWgUzjg0vg3T0dl0Ok/img.png"  width="500"/>

### 1.2. 컨슈머 관점: 사용자가 할 수 있는 일에 집중한다면?

<img src="https://blog.kakaocdn.net/dn/uRXvC/btrPS0pw7fS/exL0AbP48OIx0bqxNLKgw1/img.png"  width="500"/>

### 1.3. 컨슈머 관점 vs. 프로바이더 관점

<img src="https://blog.kakaocdn.net/dn/QyPJM/btrP0fMxaIw/Dm2hmbhPJ40VefjiQmQWW1/img.png"  width="500"/>

* API는 컨슈머의 입장에서 디자인 되어야 한다.
* 프로바이더 관점에서 아무리 특출난 기능을 가진 API를 개발했다 한들, 사용자가 이해하지 못해 사용하지 못한다면 아무 의미가 없다.

## 2. 소프트웨어 인터페이스 디자인 방법

* 사용자가 할 수 있는 일에 집중해야 한다.

### 2.1. API를 소프트웨어의 제어판처럼 바라보기

* API: 소프트웨어가 무엇을 할 수 있는지를 설명한다.
* 구현: API의 뒤에서 동작하는 코드로, 실제 진행되는 과정이 포함되어 있고, 사용자는 이 부분을 볼 수 없다.

### 2.2. 컨슈머의 관점에 집중해 단순한 API를 만들기

* 컨슈머 관점에서 디자인된 API는 내부의 동작을 숨겨주무로, 사용성이 좋아진다.
* 컨슈머가 이해하고 이해하기 쉽고 사용하기 쉬운 API를 만들기 위해서는, 컨슈머가 API를 사용할 때 달성할 수 있는 목표가 무엇인지 명확하게 식별하는 것이 중요하다.

## 3. API 의 목표 식별 과정 (인터넷 쇼핑몰 API 예시)

### 3.0. API 디자인 기초

* 누가 API를 사용하는가?
* 무엇을 할 수 있는가?
* 어떻게 하는가?
* 하기 위해서 무엇이 필요한가?
* 끝나면 무엇을 반환하는가?

### 3.1. 무엇을 어떻게 하는가

* 사용자는 무엇을 할 수 있는가?
* 사용자가 어떻게 하는가?
    * '어떻게'를 생각할 때는 반드시 과정을 분해해야 한다. 그렇지 않으면 일부 목표를 놓치게 될 가능성이 크다.
    * 분리된 각각의 '어떻게' 즉, 각가의 단계는 개별적인 목표가 된다.

### 3.2. 어떤걸 입력하고 어떤게 출력되는가

* API 의 목표를 식별하는 것은 단순히 무엇을 할 수 있느냐로 끝나는 것이 아니라, 과정 중 어떠한 데이터가 다뤄질 것인지도 함께 알아야 한다.
* 입력: 그것을 하기 위해 무엇이 필요한가?
* 출력: 그들은 무엇을 반환받는가?

### 3.3 누락된 목표가 있는가

* 입력: 입력은 어디를 통해서 들어오는가?
* 출력: 출력은 어디에서 어떻게 쓰이는가?

### 3.4. 모든 사용자를 찾아냈는가

* API를 만드는 데 있어, 다른 타입의 사용자들을 식별하는 것은 필수이다.
* 누가 사용자인가? 모든 사용자를 찾아내야 한다.
    * End Usert
    * API를 소비하는 컨슈머 애플리케이션

### 3.5. API 목표 캔버스

<img src="https://blog.kakaocdn.net/dn/WA2tI/btrP0GcglEs/4vjKdCWRuxuUVqZzBUu4b1/img.png"  width="700"/>

* 누가: API를 사용하는 사용자들 (또는 프로파일들)
* 무엇을: API로 사용자들이 할 수 있는 것들
* 어떻게: 무엇을 단계별로 분해
* 입력(원천): 각 단계를 진행하기 위해 필요한 요소들과 그것들의 원천
<br>→ 누락된 누가/무엇/어떻게를 찾기 위함
* 출처(사용처): 각 단계의 반환과 쓰임새
<br>→ 누락된 누가/무엇/어떻게를 찾기 위함
* 목표: 명시적이고 간결하게 각각의 `어떻게 + 입력 + 출력`을 재구성

## 4. API 디자인에서 피해야 할 프로바이더 관점

* 컨슈머의 관점을 유지해 이해하기 쉽고 사용하기 쉬운 API를 디자인하기 위해서는, 프로바이더 관점의 다양한 측면을 기본적으로 의식하고 있어야 한다.

### 4.1. 데이터가 미치는 영향

* API는 근본적으로 컨슈머와 프로바이더라는 두 개의 다른 소프트웨어 간의 데이터를 교환하는 방법을 의미한다.
* 일반적으로 API디자인은 데이터의 구조에 유사하게 표현되는 경향이 있다.
* 그러나, 데이터의 체계와 이름을 그대로 API 목표와 데이터에 매핑하는 것은 이해하기도 어렵고 사용하기도 어렵게 만드므로, 사용자들에게 노출하지 않도록 한다.

### 4.2. 코드와 비즈니스 로직이 주는 영향

<img src="https://blog.kakaocdn.net/dn/dMUL1H/btrQ0wuHAXv/Yp7RapIy8qk22tFrwpVv91/img.png"  width="700"/>

* API 디자인은 컨슈머로 하여금 API 내부가 어떻게 동작하는지 모르게 해야 한다. 즉, 프로바이더 관점이 들어가면 사용자의 사용성을 해칠 수 있음을 의미한다.

### 4.3. 소프트웨어 아키텍처에서 받는 영향

<img src="https://blog.kakaocdn.net/dn/19CXy/btrPR6wQIbS/1BsOWpwoHqnLq0L8egJvPk/img.png"  width="700"/>

* 컨슈머 입장에서는 상품을 검색하면 가격이 나오는 것을 원하고, 내부 아키텍처에 대해서는 궁금해하지 않으므로, 상품 가격을 가져오는 아키텍쳐는 굳이 노출할 필요가 없다.<br>
즉, `상품을 검색한다` 라는 상품 검색 API 에서 가격까지 조합해서 반환하도록 수정하는 것이 컨슈머 관점의 API 디자인이다.
* 소프트웨어 아키텍처는 항상 숨겨져 있어야 한다.

### 4.4. 인적 조직으로 인한 영향

* 조직과 전혀 무관한 외부 인물에게 조직 내부의 업무 방법을 보여줄 수 있고, 이는 API 와 전혀 관련 없는 일이다.

### 4.5. API 목표 캔버스에서 프로바이더 관점 찾기

* 캔버스를 통해 설정된 API 목표 리스트는 프로그래밍 인터페이스 디자인을 위한 토대가 된다.

## Reference

* https://itchallenger.tistory.com/787